<!doctype html>
<html>
<head>
<title>The accessible Windows 3.1 setup guide</title>
</head>
<body>
<h1 id="theaccessiblewindows31setupguidebyseedythreesixty">The accessible Windows 3.1 setup guide, by Two Thousand Stu!</h1>

<p>Hello, blind retro computing nerds, and welcome to the accessible Windows 3.1 setup guide.</p>

<p>Whether your very first computer ran Windows 3.x, or you're just experiencing it for the first time, this guide will explain everything you need to know in order to get a fully functional Windows 3.1 installation, complete with working sound and a screen reader.</p>

<hr />

<h2 id="section1whatiswindows31">Section 1: What is Windows 3.1?</h2>

<p>Microsoft Windows 3.1 was released on April 6th, 1992. Unlike the Windows we know today, Windows 3.1 is not a full-blown operating system. Instead, it is an operating environment, or shell, that runs inside of MS-DOS, or Microsoft Disk Operating System. Despite this, Windows 3.1 still needs its own set of programs, drivers and system utilities to function.</p>

<p>Windows 3.1 does not include the traditional start menu, desktop or Windows Explorer we've come to know and love today; those were introduced in its successor, Windows 95. Rather, Windows 3.1 programs are organised into program groups. These program groups can either be created by you, the user, or generated automatically by a program installer. These program groups can be accessed through the Window menu of the Windows 3.1 shell.</p>

<p>By default, Windows 3.1 does not include sound support or a screen reader for the blind and visually impaired. Therefore, we must install these things ourselves. Fear not, though, this guide will walk you through all these steps, and a whole lot more.</p>

<hr />

<h2 id="section2notesanddisclaimer">Section 2: Notes and disclaimer</h2>

<ul>
<li>Seedy, the author of this guide, shall take no responsibility for any data loss or system damage that should arise as a result of following this guide.</li>

<li>The information and instructions contained within this guide have been thoroughly researched and tested. Care has been taken to ensure the highest level of accuracy. That said, no 2 computers are the same, and no 2 people process instructions in the same way. Therefore, what works fine for one person might not work so well for another, and some might find one or more of the instructions harder to follow than others.</li>

<li>This guide will only cover DOSBox-X for Windows.</li>
</ul>

<hr />

<h2 id="section3preconfigured">Section 3: Preconfigured</h2>

<p>If you just want a preconfigured Windows 3.1 installation without going through the steps, you can <a href="/files/DOSBox-X_preinstalled.zip">download a preinstalled DOSBox-X package</a>. The only thing you'll need to do before running DOSBox-X is install com0com, the virtual serial port driver.</p>

<p>Do the following to launch the Windows 3.1 environment in DOSBox-X, assuming com0com is installed.</p>

<ol>
<li>Navigate to the vbns-ao2 folder inside the folder where you extracted the preconfigured DOSBox-X, and launch the file called start_emu to start up the virtual Braille-n-Speak.</li>

<li>Navigate to the folder where you extracted the preconfigured DOSBox-X, and launch the file called DOSBox-X.exe. If your system isn't configured to show file extensions, the second DOSBox-x file is the one you want; the first one is the program's configuration file. You can right arrow twice on a file to get its type. If it says application, that's the executable file you want. You should hear the ASAP screen reader for DOS start speaking when DOSBox-X launches.</li>

<li>In the DOSBox-X prompt, type the following commands to start Windows 3.1, pressing Enter after typing each command.</li>
<ul>

<li><blockquote>cd windows</blockquote></li>

<li><blockquote>win</blockquote></li>
</ul>

</ol>
<p>If you feel comfortable enough to set everything up yourself, let's proceed to the next section.</p>

<hr />

<h2 id="section4minimumrequirements">Section 4: Minimum requirements</h2>

<p>Hear are the things you'll need to get started following this guide. We'll download everything else later on as we need it.</p>

<ol>
<li>DOSBox-X, the MS-DOS emulator we'll be using for this exercise.
<ul>
<li><a href="https://github.com/joncampbell123/dosbox-x/releases/download/dosbox-x-v2024.07.01/dosbox-x-mingw-win64-20240702034526.zip">64-bit download</a></li>

<li><a href="https://github.com/joncampbell123/dosbox-x/releases/download/dosbox-x-v2024.07.01/dosbox-x-mingw-win32-20240702034526.zip">32-bit download</a></li></ul>
</li>
</ul>

<p>Go inside the mingw-build folder with your zip archiver of choice, and copy either the mingw or mingw-sdl2 folders to a location of your choice. Rename the newly copied folder to something easy to remember, like DOSBox. Go inside the copied folder and press Control + Shift + N to create a new folder. For the folder name, type <blockquote> CDrive</blockquote> and press Enter. You can call this folder whatever you like, but we're using CDrive because it's easy to remember. The other reason for this name will make sense later on.</li>
<li>ASAP, the screen reader for MS-DOS.
<a href="/files/asap.zip">download ASAP</a>
Extract the downloaded ASAP zip file into the CDrive folder inside your DOSBox folder.</li>
<li>com0com, the virtual serial port driver.
The screen readers we will be using require a hardware speech synthesizer. We can get around this problem using a virtual serial port driver, which is where com0com comes into play.
<a href="/files/com0com.zip">Download com0com</a></li>
<li>vbns-ao2, the tool we'll be using to emulate a Braille-n-Speak synthesizer.
<a href="/files/vbns-ao2.zip">Download vbns-ao2</a>
This tool works by piping the output of a screen reader that is configured to use a Braille-n-Speak synthesizer through a screen reader running on your physical machine, such as NVDA or JAWS. You can also tell it to pipe through SAPI 5 if you want. For convenience, a file called start_emu.bat is included in the vbns-ao2 folder. Simply extract the zip file and run the start_emu file to launch the virtualised Braille-n-Speak. When it launches, your screen reader should say 'ready'.</li>

</ol>
<hr />

<h2 id="section5installingcom0com">Section 5: Installing com0com</h2>

<ol>
<li>Extract the com0com zip file we downloaded in section 4 to a location of your choice.</li>

<li>Navigate to the location of the extracted files, and launch any of these setup files depending on your OS architecture.</li>
<ul>
<li>64-bit systems: setup-x64</li>

<li>32-bit systems: setup-x86</li>
</ul>

<li>Answer yes to the UAC prompt with Alt + Y, then the com0com setup wizard should appear. If not, Alt + Tab until you land on it.</li>

<li>Press Alt + N in the setup wizard to get past the initial screen.</li>

<li>Because you totally sat down and read that license agreement, press Alt + A to accept.</li>

<li>Press the End key, or FN + Right Arrow if you don't have an End key on your keyboard, press the space bar to uncheck the very last box in the components to install screen, and press Alt + N.</li>

<li>You will be asked to choose where the com0com program files should be installed. The default location is fine, so press Alt + I to start the installation.</li>

<li>During the install process, you'll get a windows security dialog. Unfortunately for screen reader users, this dialog does not take focus automatically, so you'll have to find it with Alt + Tab. Once you do find it, tab to the install button in the dialog and press the space bar.</li>

<li>Wait for the installation to complete, then press Alt + F when the dialog appears.</li>
</ol>

<p>Now, we need to configure the serial ports.</p>

<ol>
<li>Press Windows + R to open the run dialog, type cmd, press Control + Shift + Enter, and answer yes to the UAC prompt.</li>

<li>Type the following depending on your OS architecture.</li>

<ul>
<li>64-bit systems: <blockquote>"%programfiles(x86)%\com0com\setupc.exe"</blockquote></li>

<li>32-bit systems: <blockquote>"%programfiles%\com0com\setupc.exe"</blockquote></li>
</ul>

<li>Execute the following commands.</li>

<ul>
<li><blockquote>change CNCA0 PortName=COM8</blockquote></li>

<li><blockquote>change CNCB0 PortName=COM9</blockquote></li>

<li>Type quit to get out of com0com setup.</li>

<li>Type exit to get out of the command prompt.</li>
</ol>

<h3 id="animportantnoteforsecurebootusers">An important note for secure boot users</h3>

<p>If secure boot is enabled on your Windows 10 or 11 machine, and your system has not been upgraded from a prior version of Windows, you will need to enable driver test signing before installing com0com. You can do so by running <a href="/files/TestDriver.exe">this tool</a> as an administrator. Simply right click on the downloaded executable and select run as administrator.</p>

<aside>Note: By enabling driver test signing, you are allowing potentially dangerous drivers on to your system. We know that com0com is completely harmless, but that doesn't mean all drivers and programs are completely harmless. Always be careful of the files you download to your computer.</aside>

<hr />

<h2 id="section6configuringdosboxx">Section 6: configuring DOSBox-X</h2>

<p>While DOSBox-X has a graphical configuration tool, it is completely inaccessible to screen reader users. Therefore, we have to modify the DOSBox-X.conf file in a text editor to change settings.</p>

<p>Navigate to your DOSBox-X install folder and open DOSBox-X.conf in your text editor of choice. For those who don't have file extensions showing, DOSBox-X.conf is the very first file with 'DOSBox-X' in its name. Right arrow twice on the file to find its type. If it says conf file, that's the right file to open.</p>

<p>We need to modify 3 existing lines, and add 3 new lines. In most text editors, you can jump to a specific line number by pressing Control + G, typing in the desired line number and pressing Enter.</p>

<h3 id="linestomodify">Lines to modify</h3>

<h4 id="line211">Line 211</h4>

<p>change <blockquote>hostkey = mapper</blockquote> to <blockquote>hostkey = altshift</blockquote></p>

<p>This changes the modifier key used to perform special functions in DOSBox-X to something easier to access; F11 is the default on Windows.</p>

<h4 id="line212">Line 212</h4>

<p>Change <blockquote>mapper send key = ctrlaltdel</blockquote> to <blockquote>mapper send key = alttab</blockquote></p>
<p>Alt + Tab doesn't get passed to DOSBox-X when we're in the Windows environment, so we have to assign a special hotkey to it. In this case, it's Alt + Shift + Delete, or Alt + Shift + FN + Backspace on a notebook keyboard.</p>

<h4 id="line941">Line 941</h4>

<p>Change <blockquote>serial1 = dummy</blockquote> to <blockquote>serial1 = directserial realport:com9</blockquote></p>
<p>This tells DOSBox-X to use the physical (or virtual in our case) COM9 serial port on our machine.</p>

<h3 id="linestoadd">Lines to add</h3>

<p>Press Control + End, or Control + FN + Right Arrow, to go to the very bottom of the file, and add these 3 lines.</p>

<ul>
<li>mount C: CDrive</li>

<li>C:</li>

<li>asap\asap.com bns com1</li>
</ul>

<p>Now, every time we launch DOSBox-X, it will mount the C: drive using the CDrive folder we made in section 4, change to the C: drive, and start the ASAP screen reader.</p>

<hr />

<h2 id="section7installingwindows">Section 7: Installing Windows</h2>

<p>After all that installing and configuring, it's finally time for the fun part, installing Windows 3.1!</p>

<p>For convenience, you can <a href="/files/Win31.zip">download a pre-extracted Windows for Workgroups 3.11 setup</a>. This zip file contains all the files required to set up Windows in a single folder, meaning you don't have to keep swapping floppy disks. Simply extract the zip file into your DOSBox-X CDrive folder.</p>

<p>Windows for Workgroups 3.11 is an updated version of Windows 3.1 from 1993 that includes networking support and a few other improvements. We won't cover networking in this guide, but if there's enough demand for it, I'll look into adding a section on networking.</p>

<p>So, without any further ado, let's install Windows!</p>

<ol>
<li>Navigate to your vbns-ao2 folder and open the start_emu file to launch the virtual Braille-n-Speak.</li>

<li>Navigate to your DOSBox-X folder and launch the DOSBox-X executable file. ASAP should start to speak right away when DOSBox-X fires up. If not, go back through the guide and make sure you installed and configured everything correctly.</li>

<li>Type <blockquote>cd Win31</blockquote> to change to the Win31 folder we extracted earlier.</li>

<li>Type setup to launch the Windows for Workgroups 3.11 setup program.</li>

<li>Press Enter to get past the welcome screen and start setup.</li>

<li>We can now choose between 2 setup types: express, and custom. To speed things up, we'll choose Express, which will let Windows configure default settings for us. Express is highlighted, so press Enter.</li>

<li>Wait 2 to 3 minutes for files to be copied and hardware to be found. With the NVDA screen reader, you can use OCR to check on progress with the NVDA modifier key + the letter R.</li>

<li>Windows will now ask you to enter your name, company, and product number. You are automatically placed in the name field, so type your full name or common handle. If you're not in a company and/or don't have a Windows registration card, you can just leave these fields blank. Otherwise, press the Tab key to navigate to the appropriate field and type in your data. From the name field, Tab once for company, Tab again for product number. Once the desired information has been entered, press Enter.</li>

<li>You will be asked to verify if the data you just entered is right. If so, press Enter.</li>

<li>Wait 1 to 2 minutes for files to be copied.</li>

<li>The printer installation wizard will then appear. Just press Enter here, as we won't be installing any printers.</li>

<li>At the network setup screen, press Enter, as we won't be installing networking.</li>

<li>5 to 10 seconds later, A Windows tutorial screen will appear. We don't want to go through the inaccessible tutorial, so press the Tab key once and press Enter.</li>

<li>Press Enter one more time to exit setup. You will be rebooted back to MS-DOS. Windows for Workgroups 3.11 is successfully installed!</li>
</ol>

<hr />

<h2 id="section8sounddrivers">Section 8: Sound drivers</h2>

<p>This Windows installation is pretty useless to us right now because we have no audio. By default, DOSBox-X emulates a Creative Sound Blaster 16 card. We need to install the drivers for this card in order for Windows to see it and give us sound.</p>

<ol>
<li><a href="/files/sb16w31.zip">Download the SB16 driver</a> and extract it to your CDrive folder.</li>

<li>In DOSBox-X, type <blockquote>cd sb16win31</blockquote> to change to the driver directory.</li>

<li>type install to start the installer.</li>

<li>When ASAP prompts you, press enter to dismiss the initial screen. ASAP will speak very minimally during this setup, so feel free to use OCR if you need to.</li>

<li>Press Enter for recommended settings.</li>

<li>3 to 5 seconds later, a list of default settings will appear. Up arrow twice, press Enter, and press Enter again to choose the default path of C:\Windows. Press Enter once again to accept the settings.</li>

<li>after 5 to 10 seconds, another list of settings will come up. Press the Up Arrow 3 times, press Enter, Down Arrow once to set the IRQ value to 7, and press Enter again. We're satisfied with those settings, so press Enter once again.</li>

<li>The rest of the install process will take 3 to 5 minutes. If you get a backup/skip/proceed prompt, Down Arrow twice to the proceed option and press Enter.</li>

<li>When the installation is complete, press F10 to reboot MS-DOS.</li>

<li>Type the following commands to launch Windows and test the sound.</li>

<ul>
<li>cd windows</li>

<li>win</li>

<li>If everything worked, you should hear a chime to indicate Windows has started.</li>

<li>Finally, Press Escape to dismiss the audio software dialog.</li>
</ol>

<hr />

<h2 id="section9thescreenreader">Section 9: The screen reader</h2>

<p>The last thing we need to do to make this thing accessible is install a screen reader. The reader we will be using in this exercise is Window-Eyes 3.1. That's nice and easy to remember, because Windows 3.1, Window-Eyes 3.1.</p>

<aside>Note: in Windows 3.x, Window-Eyes will not provide speech during setup.</aside>

<ol>
<li><a href="/files/wineyes.zip">Download Window-Eyes 3.1</a> and extract it into your CDrive folder.</li>

<li>In DOSBox-X, With the Windows 3.1 shell in view, press Alt + F, then the letter R for Run.</li>

<li>Type <blockquote>C:\wineyes\setup</blockquote> and press Enter to launch the setup program. In a few seconds, you should hear a short audio message welcoming you to Window-Eyes 3.1.</li>

<li>After the welcome message, a dialog will appear asking if you want to use quick setup. We do, so press Y.</li>

<li>You will then be asked to enter your name and company; sound familiar? None of this matters and we can just leave it blank, so press Enter.</li>

<li>In the synthesizer selection screen, press Shift + Tab twice, press the letter B for braille, Up Arrow once, and press enter.</li>

<li>In 1 to 2 minutes, the setup will be complete. Press Enter, and you will once again be rebooted back to DOS.</li>

<li>When you launch Windows 3.1 again, Window-Eyes should start to speak, and you can use the arrow keys to move around.</li>
</ol>

<hr />

<h2 id="section10thesoundofmusic">Section 10: The sound of music</h2>

<p>Midi freaks, I see you! DOSBox-X does a good job of emulating SB16 midi, but it sounds terrible by default. Let's sort that out now!</p>

<ol>
<li>In the Windows 3.1 shell, press Alt + W to access the window menu.</li>

<li>Down Arrow until you find the 'Main' program group and press Enter.</li>

<li>Inside the program group, press C for Control Panel and press Enter.</li>

<li>Inside the Windows control panel, press the letter M until you hear Midi Mapper, and press Enter.</li>

<li>We want to choose the SB16 All Midi option, so press Tab once, press Home or FN + Left Arrow to highlight the option, press Enter to select, and Alt + F4 to get out of Control Panel.</li>

<li>To test it out, press Alt + F, press R for Run, type canyon.mid, hit Enter, and press the space bar to play the file. See how much better that is?</li>
</ol>

<hr />

<h2 id="section11conclusion">Section 11: Conclusion</h2>

<p>Congratulations! You now have a fully working and accessible package of MS-DOS and Windows 3.1! Feel free to explore the environment, get a feel for the different program groups, Windows settings, and just play around. If there's enough demand, I'll look into installing a game or 2!</p>

<p>To shut down DOSBox-X at any time, press Control + F9.</p>

<hr />

<h2 id="section12creditsandthanks">Section 12: Credits and thanks</h2>

<ul>
<li>Huge thanks to Tyler Spivey's <a href="https://allinaccess.com/dosbox-guide/">DOSBox guide</a> which inspired this whole project!</li>

<li>The <a href="https://dosbox-x.com/wiki/#Home">DOSBox-X wiki</a> was a great help when writing this guide, especially when it came to downloading drivers.</li>

<li><a href="https://datajake.braillescreen.net">Jake Gross's website</a> is a huge library of retro programs, games, audio files, software manuals, midi files and more.</li>
</ul>

<h2 id="section13connectwithseedy">Section 13: Connect with Seedy</h2>

<ul>
<li><a href="https://seedy.cc">Visit my personal website</a></li>

<li><a href="https://seediffusion.cc">Visit the Seediffusion site</a></li>

<li><a href="https://fwoof.space/@TheCube">Follow me on Mastodon</a></li>

<li><a href="https://tweesecake.social/@seediffusion">Follow Seediffusion on Mastodon</a></li>

<li><a href="mailto:seedy@seediffusion.cc?subject=Hi Seedy">Send me an email</a></li>

<li>Discord: seedy360</li>

<li>Skype: SeedyThreeSixty</li>

<li><a href="https://t.me/SeedyThreeSixty">Send me a telegram</a></li>

<li><a href="https://ko-fi.com/seediffusion">Support Seedy on Ko-Fi</a></li>

<li>PayPal: seedy360@hotmail.com</li>
</ul>
</body>
</html>